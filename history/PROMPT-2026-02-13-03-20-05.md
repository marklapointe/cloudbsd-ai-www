Make sure to be very granular, like list user roles and permissions in a list in this document, 
so I can append to them here and rerun because this is the design document. If I blow away the code , I want this to be repeatable as possible.

So even when stating that there is a view, describe in this document the size of the view area, objects, and their placement

Security is a priority for me; everything should have SSL/TLS enabled.
If keys aren't present, generate them and store them in `/usr/local/etc/cloudbsd/admin-panel/ssl/`. 
But we should use a self-signed cert for local development in the current project directory, but check for certbot certificates and to be able to use them. 
In the json config I should be able to set the servername and port

### Accomplishments & Features

1.  **Core Platform**:
    - Scaffolded a modern React + TypeScript frontend using Vite and Tailwind CSS.
    - Implemented an Express.js backend refactored for ESM compatibility (`ts-node-dev --esm`).
    - SQLite database integration (`better-sqlite3`) with lazy initialization and startup health checks.
    - Robust, priority-based configuration system (Local `etc/config.json` > System > Defaults).
    - Full SSL/TLS support with automatic self-signed certificate generation and Certbot compatibility.

2.  **Security & Authentication**:
    - JWT-based authentication with `bcryptjs` password hashing.
    - Role-Based Access Control (RBAC) with three distinct roles: Admin, Operator, and Viewer.
    - Comprehensive Audit Logging for all system-wide actions.
    - Global backend connectivity monitoring with immediate UI feedback (Red Bar notification).

3.  **Infrastructure Management**:
    - Unified management of Virtual Machines (bhyve), Docker, FreeBSD Jails, and Podman.
    - Modular `ResourceList` component providing consistent CRUD and management operations.
    - Real-time terminal access via `xterm.js` and WebSockets for containers and jails.
    - VNC console integration placeholder for virtual machines.

4.  **Monitoring & Telemetry**:
    - Real-time system health metrics (CPU, Memory, Disk, Network) on the Dashboard.
    - Enhanced host telemetry using Node's `os` module (CPU model, load averages, detailed RAM stats).
    - Browser-side telemetry (Browser, Platform, Language) displayed in the UI.

5.  **DevOps & Documentation**:
    - Automated unit testing with Vitest and React Testing Library (100% pass rate for core logic).
    - Interactive API documentation via Swagger/OpenAPI at `/api-docs`.
    - Containerization support with dedicated `Containerfile`s for frontend and backend.
    - FreeBSD `pkg` port structure and `rc.d` script for native deployment.
    - Mandatory versioned history snapshots for `PROMPT.md` in `history/` directory.

### UI Layout & Components

The application follows a **Desktop-First** responsive design.

#### 1. Global Layout
- **Navigation (Left Sidebar)**: Slate-900 (`#0f172a`), 256px wide. Contains brand logo, navigation links with Lucide icons, and user profile/logout.
- **Header Bar**: Fixed red notification bar (`#dc2626`) appears at the very top only when the backend is unreachable.
- **Main Content**: Gray-100 (`#f3f4f6`) background with 32px padding. Card-based layout for all data views.

#### 2. Dashboard View
- **Summary Cards**: Quick stats for VMs, Docker, Jails, and Podman.
- **System Health**: Progress bars for real-time CPU, RAM, and Disk usage; Network I/O metrics.
- **Telemetry**: Server Info (Hostname, OS, CPU, Uptime, Load) and Web Frontend Info.

#### 3. Resource Views
- **Standardized Table**: Displays resource name, type-specific metadata (Image/IP/CPU/RAM), and status badges.
- **Action Suite**: Console (Terminal), Start, Stop, Restart, Edit, and Delete buttons.
- **Status Badges**: Emerald for active states (`running`, `up`, `active`), Slate for inactive states.

#### 4. Console Modal
- **Size**: Large modal (`max-w-4xl`, 600px height) with `xterm.js` terminal.
- **VNC**: Specialized placeholder view for VM graphical consoles.

#### 5. User Management View
- **Header**: Title and Description.
- **Add User Form**: Sidebar-style or top-section form.
    - Fields: Username, Password, Role (Select: Admin, Operator, Viewer).
- **Users Table**: List of all accounts with Role badges and Delete buttons.

#### 6. Audit Logs View
- **Logs Table**: Chronological list of system actions.
    - Columns: Timestamp, User, Action (e.g., LOGIN_SUCCESS, RESOURCE_START), Details.

### User Roles & Permissions

-   **Admin** (`role: 'admin'`)
    -   **Permissions**: `*.*` (Full access).
    -   **User Management**: Can create and delete any user.
    -   **Audit Logs**: Full read access.
    -   **Resources**: Create, Read, Update, Delete (CRUD), and execute actions (Start, Stop, Restart, Console) on all resource types.
    -   **System**: View all system stats and info.

-   **Operator** (`role: 'operator'`)
    -   **Permissions**: `resource.*`, `system.read`.
    -   **User Management**: No access. Sidebar link hidden.
    -   **Audit Logs**: No access. Sidebar link hidden.
    -   **Resources**: CRUD access to resources, and can execute actions (including Console).
    -   **System**: Read-only access to stats and info.

-   **Viewer** (`role: 'viewer'`)
    -   **Permissions**: `*.read`.
    -   **User Management**: No access.
    -   **Audit Logs**: No access.
    -   **Resources**: Read-only access. Actions and "New" buttons are disabled/hidden.
    -   **System**: Read-only access to stats and info.


### Technical Specifications

#### 1. Database Schema (SQLite)
- **`users`**: `id` (PK), `username` (Unique), `password` (Hashed), `role` (admin/operator/viewer).
- **`resources`**: `id` (PK), `type` (vms/docker/jails/podman), `name`, `status`, `image`, `ip`, `cpu`, `memory`, `created_at`.
- **`logs`**: `id` (PK), `timestamp`, `user_id` (FK), `action`, `details`.
- **`permissions`**: `id` (PK), `user_id` (FK), `resource`, `action`.

#### 2. API Endpoints
- **Auth**: `GET /api/health` (Public), `POST /api/login`.
- **Users (Admin)**: `GET /api/users`, `POST /api/users`, `DELETE /api/users/:id`.
- **Logs (Admin)**: `GET /api/logs`.
- **Resources**: `GET /api/:resource`, `POST /api/:resource`, `PUT /api/:resource/:id`, `DELETE /api/:resource/:id`, `POST /api/:resource/:id/:action`.
- **System**: `GET /api/system/stats`, `GET /api/system/info`, `GET /api/system/config` (Admin), `GET /api/system/host`.

#### 3. Documentation & History
- **Snapshots**: Every significant update requires a copy in `history/`.
- **Format**: `PROMPT-<YEAR>-<MONTH>-<DAY>-<HOUR>-<MINUTE>-<SECOND>.md`.
- **License**: BSD 3-Clause (Mark LaPointe <mark@cloudbsd.org>).

### Rationale
- **SQLite & ESM**: Zero-config persistence with modern Node.js standards.
- **Vite & Tailwind**: High-performance development and consistent, responsive styling.
- **Modular Components**: Unified `ResourceList` ensures maintainability across virtualization types.
- **Connectivity Monitoring**: Essential for real-time status awareness in infrastructure tools.
- **OpenAPI**: Facilitates integration and serves as a living contract for the backend.
